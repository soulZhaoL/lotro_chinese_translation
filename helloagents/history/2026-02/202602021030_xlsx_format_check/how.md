# 技术设计: xlsx 固定格式计数脚本

## 技术方案
### 核心技术
- Python 3
- openpyxl（读取 xlsx）
- re（正则匹配固定格式）

### 实现要点
- 定义 3 类基础正则，按 "|||" 拆分后对每段做完整匹配：
  - 9位数字 + 6个冒号 + [内容]
  - 9位数字 + ::: + 数字 + ::: + [内容]
  - 9位数字 + ::: + 数字-数字(+更多) + ::: + [内容]
- 计数逻辑：对拆分后的每段进行类型匹配，匹配成功则计数 +1。
- 输出逻辑：逐行输出行号与计数，支持可选的 C/D 列对比并标记不一致行。
- 提供 CLI 参数：xlsx 路径、sheet、列、行范围、是否对比列。

## 安全与性能
- **安全:** 只读 xlsx；不写入任何数据；不处理外部网络输入。
- **性能:** 仅读取指定行范围，避免全量加载。

## 测试与部署
- **测试:** 手动运行脚本解析 work_text/text_work.xlsx 前 100 行，确认输出数量与预期格式一致。
- **部署:** 无需部署，离线脚本执行。
